// =================================================================
//  Master config for managing various command aliases and settings
// =================================================================

// This alias allows for common commands to be executed, even on both
// dedicated servers and normal clients. If dedicated, then it remains
// as sv_cmd... If a normal client, then it is changed to menu_cmd.
alias qc_cmd "sv_cmd $*" 

// Execute commands based on whether it is dedicated a server or a client.
alias "_detect_dedicated_$qport" "${* asis}"
alias "_detect_dedicated_0" ""
alias _if_dedicated "_detect_dedicated_$qport ${* asis}"
alias if_client "${* asis}"
alias if_dedicated "${* asis}"
_if_dedicated alias if_client ""
if_client alias if_dedicated ""


// ========
//  common
// ========
if_client alias teamstatus "cmd teamstatus"
if_dedicated alias teamstatus "sv_cmd teamstatus"

if_client alias who "cmd who"
if_dedicated alias who "sv_cmd who"
alias w who

alias g_hitplots_add "qc_cmd rpn /g_hitplots_individuals g_hitplots_individuals ${1 !} union def"
alias g_hitplots_remove "qc_cmd rpn /g_hitplots_individuals g_hitplots_individuals ${1 !} difference def"

alias g_maplist_add	"qc_cmd maplist add ${* ?}"
alias g_maplist_remove	"qc_cmd maplist remove ${* ?}"
alias g_maplist_putfirst	"qc_cmd maplist remove ${* ?} ; qc_cmd maplist add ${* ?}"
alias g_maplist_shufflenow	"qc_cmd maplist shuffle"
alias g_maplist_cleanup	"qc_cmd maplist cleanup" // removes maps that don't exist from the map list

alias addfav "qc_cmd addtolist net_slist_favorites ${* ?}"
alias addvote "qc_cmd addtolist sv_vote_commands ${* ?}"


// ========================
//  engine command aliases
// ========================
alias bsp "ls maps/*.bsp"
alias chmap "changelevel ${* ?}"
alias rec "record demos/${1 !}"
alias ply "playdemo $1"
alias tdem "timedemo $1"
alias sv_loadconfig "exec $serverconfig"
alias sv_restart "say \"Server will restart at the end of the match, you will all be reconnected automatically. ${* ?} \"; quit_and_redirect self"


// ===============================================
//  menu_cmd (menu command) - menu/gamecommand.qc
// ===============================================
alias menu_showteamselect "menu_cmd directmenu TeamSelect"
alias menu_showhudexit "menu_cmd directmenu HUDExit"
alias menu_showhudoptions "menu_cmd directpanelhudmenu ${* ?}"
alias menu_showsandboxtools "menu_cmd directmenu SandboxTools"

// command executed before loading a map by the menu
// makes sure maxplayers is at least minplayers or bot_number + 1
alias _menu_loadmap_prepare_maxpl "maxplayers $_menu_loadmap_maxplayers"
alias menu_loadmap_prepare "disconnect; wait; g_campaign 0; menu_cmd rpn /_menu_loadmap_maxplayers menu_maxplayers minplayers bot_number 1 add max max def; _menu_loadmap_prepare_maxpl; g_maplist_shufflenow"


// =========================================================
//  cl_cmd (client console command) - client/gamecommand.qc
// =========================================================
alias radar "cl_cmd hud_panel_radar_maximized"
alias scoreboard_columns_set  "cl_cmd scoreboard_columns_set ${* ?}"
alias scoreboard_columns_set  "" // aliased later
alias scoreboard_columns_help "cl_cmd scoreboard_columns_help ${* ?}"


// ===========================================================
//  cmd (client-to-server command) - server/clientcommands.qc
// ===========================================================
set sv_clientcommand_antispam_time 1 "Amount of seconds after a command before another command can be called again without being considered spam. (Use -1 for no antispam limit)"
set sv_clientcommand_antispam_count 5 "Amount of commands considered spam before commands are rejected.

seta sv_status_privacy 1 "hide IP addresses from \"status\" and \"who\" replies shown to clients"

seta cl_autoswitch 1 "automatically switch to newly picked up weapons if they are better than what you are carrying"

alias autoswitch "set cl_autoswitch ${1 ?} ; cmd autoswitch ${1 ?}"

alias records "cmd records"
alias rankings "cmd rankings"
alias ladder "cmd ladder"

alias ready "cmd ready"
alias cointoss "sv_cmd cointoss"
alias timeout "cmd timeout" //use this command to call a timeout
alias timein "cmd timein" //use this command to resume the game before timeout is finished

alias lsmaps "cmd lsmaps" // lists all maps on server (for vmap, suggestmap, vnextmap)
alias lsnewmaps "cmd lsnewmaps" // lists all maps on server that do not yet have a record set (race/cts)

alias team_red "cmd selectteam red; cmd join"
alias team_blue "cmd selectteam blue; cmd join"
alias team_pink "cmd selectteam pink; cmd join"
alias team_yellow "cmd selectteam yellow; cmd join"
alias team_auto "cmd selectteam auto; cmd join"

alias sandbox "cmd g_sandbox ${* ?}"

alias spec "cmd spectate"
alias suggestmap "cmd suggestmap ${1 ?}"


// =========================================================
//  sv_cmd (server console command) - server/gamecommand.qc
// =========================================================
alias adminmsg	"sv_cmd adminmsg ${* ?}"
alias allready "sv_cmd allready"

alias endmatch "timelimit -1"

alias extendmatchtime "sv_cmd extendmatchtime"
alias reducematchtime "sv_cmd reducematchtime"

alias printstats	"sv_cmd printstats" // print stats on demand

alias gametype "sv_cmd gametype ${* ?}"

alias savedb "sv_cmd database save \"${1 ?}\""
alias dumpdb "sv_cmd database dump \"${1 ?}\""
alias loaddb "sv_cmd database load \"${1 ?}\""

alias movetoteam_red "sv_cmd movetoteam ${1 ?} red"
alias movetoteam_blue "sv_cmd movetoteam ${1 ?} blue"
alias movetoteam_pink "sv_cmd movetoteam ${1 ?} pink"
alias movetoteam_yellow "sv_cmd movetoteam ${1 ?} yellow"
alias movetoteam_auto "sv_cmd movetoteam ${1 ?} auto"

alias lockteams "sv_cmd lockteams"
alias unlockteams "sv_cmd unlockteams"
alias nospectators "sv_cmd nospectators"
alias gotomap "sv_cmd gotomap \"${1 ?}\""
alias warp "sv_cmd warp ${* ?}"


// =======================================================
//  Aliases for settemp subsystem. Warning: Do not touch. 
//  Usage: settemp variable value, next map resets it.
// =======================================================
set settemp_list 0
set settemp_idx 0
set _settemp_var UNUSED
alias settemp "_settemp_var \"_settemp_x$settemp_idx\"; qc_cmd rpn /settemp_idx settemp_idx 1 add def; _settemp \"$1\" \"$2\""
alias _settemp "settemp_list \"1 $1 $_settemp_var $settemp_list\"; set $_settemp_var \"${$1}\"; $1 \"$2\""
alias settemp_restore "_settemp_restore_${settemp_list asis}"
alias _settemp_restore_0 "set settemp_var 0; set settemp_list 0"
alias _settemp_restore_1 "$1 \"${$2}\"; _settemp_restore_${3- asis}"


// ===========================
//  banning - server/ipban.qc
// ===========================
alias bans "sv_cmd bans"
alias ban "sv_cmd ban ${* ?}"         // usage: ban address(maybe incomplete, like 1.2.3) bantime(seconds)
alias kickban "sv_cmd kickban ${* ?}" // usage: kickban # playerno bantime(seconds) masksize(bytes)
alias unban "sv_cmd unban ${* ?}"     // usage: unban 3 (number from bans)


// =========================
//  voting - server/vote.qc
// =========================
set sv_vote_call 1 "Allow users to call a vote for the commands in sv_vote_commands"
set sv_vote_change 1 "Allow voters to change their mind after already voting"
set sv_vote_commands "restart fraglimit chmap gotomap nextmap endmatch reducematchtime extendmatchtime allready kick cointoss movetoteam_auto" "these commands can be voted"
set sv_vote_only_commands ""
set sv_vote_master_commands "movetoteam_red movetoteam_blue movetoteam_yellow movetoteam_pink"	"maybe add kickban here (but then sv_vote_master 0)"
set sv_vote_master 1	"Allows the use of the vote master system"
set sv_vote_master_callable 1 "When set, users can use \"vmaster\" to call a vote to become master of voting commands"
set sv_vote_master_password "" "when set, users can use \"vlogin PASSWORD\" to log in as master"
set sv_vote_master_playerlimit 2 "Minimum number of players needed for a player to be allowed to vote for master"
set sv_vote_singlecount 0	"set to 1 to count votes once after timeout or to 0 to count with every vote"
set sv_vote_timeout 30	"a vote will timeout after this many seconds"
set sv_vote_wait 120	"a player can not call a vote again for this many seconds when his vote was not accepted"
set sv_vote_stop 15	"a player can not call a vote again for this many seconds when he stopped this vote (e.g. to correct it)"
set sv_vote_majority_factor 0.5	"What percentage of the PLAYERS constitute a majority? (Must be at least 0.5, recommended: 0.5)"
set sv_vote_majority_factor_of_voted 0.5 "What percentage of the VOTERS constitute a majority too? (Must be at least 0.5, recommended: 0.5)"
// when disabled, don't allow game type changes "note: set these two equal to JUST support simple majorities"
set sv_vote_override_mostrecent 0

alias vhelp "cmd vote help"
alias vstatus "cmd vote status"
alias vcall "cmd vote call ${* ?}"
alias vstop "cmd vote stop"
alias vmaster "cmd vote master"
alias vlogin "cmd vote login ${* ?}"
alias vdo "cmd vote do ${* ?}"
alias vyes "cl_cmd vyes"
alias vno "cl_cmd vno"
alias vdontcare "cmd vote dontcare"
alias vabstain "cmd vote abstain"

alias vmap "vcall gotomap ${1 ?}"
alias vnextmap "vcall nextmap ${1 ?}"
alias vkick "vcall kick ${1 ?}"
alias vkickban "vcall kickban ${1 ?}"
alias vend "vcall endmatch"
alias vdomap "vdo gotomap ${1 ?}"
alias vdokick "vdo kick ${* ?}"
alias vdokickban "vdo kickban ${* ?}"
alias vdoend "vdo endmatch"

// ======================
//  rcon server commands
// ======================
rcon_secure 1
set rcon_restricted_commands "restart fraglimit chmap gotomap endmatch reducematchtime extendmatchtime allready kick kickban \"sv_cmd bans\" \"sv_cmd unban *\" status \"sv_cmd teamstatus\" movetoteam_auto movetoteam_red movetoteam_blue movetoteam_yellow movetoteam_pink"
